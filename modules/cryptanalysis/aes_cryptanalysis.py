from modules.base_module import CryptoModule
import streamlit as st
import pandas as pd
import numpy as np
import secrets
import time
from typing import List, Tuple, Dict
import matplotlib.pyplot as plt
import seaborn as sns

class AESCryptanalysisModule(CryptoModule):
    def __init__(self):
        super().__init__()
        self.name = "–ö—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑ AES"
        self.description = "–ú–µ—Ç–æ–¥—ã –∞–Ω–∞–ª–∏–∑–∞ –∏ –∞—Ç–∞–∫ –Ω–∞ Advanced Encryption Standard"
        self.complexity = "expert"
        self.category = "cryptanalysis"
        self.icon = ""
        self.order = 4
    
    def render(self):
        st.title("üîç –ö—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑ AES")
        
        # –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞
        with st.expander("üìö –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞", expanded=False):
            st.markdown("""
            **–ö—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑ AES** - –∏–∑—É—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –≤—Å–∫—Ä—ã—Ç–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ Advanced Encryption Standard.
            
            **–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã –∞—Ç–∞–∫ –Ω–∞ –±–ª–æ—á–Ω—ã–µ —à–∏—Ñ—Ä—ã:**
            
            **1. –ê—Ç–∞–∫–∏ –ø–æ–ª–Ω—ã–º –ø–µ—Ä–µ–±–æ—Ä–æ–º (Brute Force)**
            - –ü–µ—Ä–µ–±–æ—Ä –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∫–ª—é—á–µ–π
            - –î–ª—è AES-128: 2¬π¬≤‚Å∏ ‚âà 3.4 √ó 10¬≥‚Å∏ –æ–ø–µ—Ä–∞—Ü–∏–π
            - –î–ª—è AES-256: 2¬≤‚Åµ‚Å∂ ‚âà 1.1 √ó 10‚Å∑‚Å∑ –æ–ø–µ—Ä–∞—Ü–∏–π
            
            **2. –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑**
            - –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–ª–∏—á–∏–π –≤ –ø–∞—Ä–∞—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö/–∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤
            - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø—Ä–æ—Ç–∏–≤ DES, –Ω–æ –Ω–µ –ø—Ä–æ—Ç–∏–≤ AES
            - –°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è AES: >2¬π‚Å∞‚Å∞ –æ–ø–µ—Ä–∞—Ü–∏–π
            
            **3. –õ–∏–Ω–µ–π–Ω—ã–π –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑**
            - –ü–æ–∏—Å–∫ –ª–∏–Ω–µ–π–Ω—ã—Ö –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–π –º–µ–∂–¥—É –æ—Ç–∫—Ä—ã—Ç—ã–º —Ç–µ–∫—Å—Ç–æ–º, —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–æ–º –∏ –∫–ª—é—á–æ–º
            - –î–ª—è AES —Å–ª–æ–∂–Ω–æ—Å—Ç—å >2¬π¬≤‚Å∞ –æ–ø–µ—Ä–∞—Ü–∏–π
            
            **4. –ê—Ç–∞–∫–∏ –ø–æ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º –∫–∞–Ω–∞–ª–∞–º**
            - –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
            - –ê–Ω–∞–ª–∏–∑ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è
            - –ê–Ω–∞–ª–∏–∑ —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω–æ–≥–æ –∏–∑–ª—É—á–µ–Ω–∏—è
            
            **5. –ê—Ç–∞–∫–∏ –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**
            - –ê—Ç–∞–∫–∏ –Ω–∞ –∫—ç—à-–ø–∞–º—è—Ç—å
            - –û—à–∏–±–∫–∏ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
            - –ê—Ç–∞–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
            
            **–ü–æ—á–µ–º—É AES —Å—Ç–æ–π–∫–∏–π:**
            - –•–æ—Ä–æ—à–æ –∏–∑—É—á–µ–Ω —Å 2001 –≥–æ–¥–∞
            - –ù–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∞—Ç–æ–∫ –ª—É—á—à–µ –ø–æ–ª–Ω–æ–≥–æ –ø–µ—Ä–µ–±–æ—Ä–∞
            - –£—Å—Ç–æ–π—á–∏–≤ –∫ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º—É –∏ –ª–∏–Ω–µ–π–Ω–æ–º—É –∞–Ω–∞–ª–∏–∑—É
            - –®–∏—Ä–æ–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
            """)
        
        st.markdown("---")
        
        # –í—ã–±–æ—Ä —Ç–∏–ø–∞ –∞—Ç–∞–∫–∏
        attack_type = st.radio(
            "–¢–∏–ø –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑–∞:",
            ["‚ö° –ê—Ç–∞–∫–∞ –ø–æ–ª–Ω—ã–º –ø–µ—Ä–µ–±–æ—Ä–æ–º", "üìä –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑", "üìà –õ–∏–Ω–µ–π–Ω—ã–π –∞–Ω–∞–ª–∏–∑", 
             "‚è±Ô∏è –ê—Ç–∞–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏", "üî¨ –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑", "üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"],
            horizontal=True
        )
        
        if attack_type == "‚ö° –ê—Ç–∞–∫–∞ –ø–æ–ª–Ω—ã–º –ø–µ—Ä–µ–±–æ—Ä–æ–º":
            self.render_brute_force_analysis()
        elif attack_type == "üìä –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑":
            self.render_differential_analysis()
        elif attack_type == "üìà –õ–∏–Ω–µ–π–Ω—ã–π –∞–Ω–∞–ª–∏–∑":
            self.render_linear_analysis()
        elif attack_type == "‚è±Ô∏è –ê—Ç–∞–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏":
            self.render_timing_analysis()
        elif attack_type == "üî¨ –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑":
            self.render_comparative_analysis()
        else:
            self.render_protection_recommendations()
    
    def render_brute_force_analysis(self):
        """–ê–Ω–∞–ª–∏–∑ –∞—Ç–∞–∫–∏ –ø–æ–ª–Ω—ã–º –ø–µ—Ä–µ–±–æ—Ä–æ–º"""
        st.subheader("‚ö° –ê—Ç–∞–∫–∞ –ø–æ–ª–Ω—ã–º –ø–µ—Ä–µ–±–æ—Ä–æ–º –Ω–∞ AES")
        
        col1, col2 = st.columns(2)
        
        with col1:
            key_size = st.selectbox(
                "–†–∞–∑–º–µ—Ä –∫–ª—é—á–∞ AES:",
                ["AES-128", "AES-192", "AES-256"],
                key="brute_key_size"
            )
            
            computing_power = st.selectbox(
                "–í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å:",
                ["–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä (10‚Åπ –∫–ª—é—á–µ–π/—Å–µ–∫)", 
                 "–°—É–ø–µ—Ä–∫–æ–º–ø—å—é—Ç–µ—Ä (10¬π¬≤ –∫–ª—é—á–µ–π/—Å–µ–∫)",
                 "–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (10¬π‚Åµ –∫–ª—é—á–µ–π/—Å–µ–∫)",
                 "–ö–≤–∞–Ω—Ç–æ–≤—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä (10¬≤‚Å∞ –∫–ª—é—á–µ–π/—Å–µ–∫)"],
                key="computing_power"
            )
        
        with col2:
            budget = st.number_input(
                "–ë—é–¥–∂–µ—Ç –∞—Ç–∞–∫–∏ (–º–∏–ª–ª–∏–æ–Ω—ã $):",
                min_value=1,
                max_value=1000000,
                value=100,
                key="attack_budget"
            )
            
            if st.button("–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –≤—Ä–µ–º—è –≤–∑–ª–æ–º–∞", key="brute_calc_btn"):
                self.calculate_brute_force_time(key_size, computing_power, budget)
        
        # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–±–æ—Ä–∞
        st.markdown("---")
        st.subheader("üéØ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–±–æ—Ä–∞ –∫–ª—é—á–µ–π")
        
        if st.button("–ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é –ø–µ—Ä–µ–±–æ—Ä–∞", key="demo_brute_btn"):
            self.demo_brute_force()
        
        # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç–æ–π–∫–æ—Å—Ç–∏
        st.markdown("---")
        self.render_brute_force_info()
    
    def render_brute_force_info(self):
        """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç–æ–π–∫–æ—Å—Ç–∏ –∫ brute force"""
        st.subheader("üí° –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç–æ–π–∫–æ—Å—Ç–∏ AES –∫ –ø–æ–ª–Ω–æ–º—É –ø–µ—Ä–µ–±–æ—Ä—É")
        
        col1, col2 = st.columns(2)
        
        with col1:
            st.markdown("""
            **–§–∞–∫—Ç–æ—Ä—ã, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ –≤—Ä–µ–º—è –≤–∑–ª–æ–º–∞:**
            
            üîπ **–†–∞–∑–º–µ—Ä –∫–ª—é—á–∞:**
            - AES-128: 2¬π¬≤‚Å∏ –∫–ª—é—á–µ–π
            - AES-192: 2¬π‚Åπ¬≤ –∫–ª—é—á–µ–π  
            - AES-256: 2¬≤‚Åµ‚Å∂ –∫–ª—é—á–µ–π
            
            üîπ **–í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å:**
            - –û–±—ã—á–Ω—ã–π –ü–ö: 10‚Åπ –∫–ª—é—á–µ–π/—Å–µ–∫
            - –°—É–ø–µ—Ä–∫–æ–º–ø—å—é—Ç–µ—Ä: 10¬π¬≤ –∫–ª—é—á–µ–π/—Å–µ–∫
            - –°–ø–µ—Ü. —Å–∏—Å—Ç–µ–º–∞: 10¬π‚Åµ –∫–ª—é—á–µ–π/—Å–µ–∫
            
            üîπ **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è:**
            - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
            - GPU/FPGA —É—Å–∫–æ—Ä–µ–Ω–∏–µ
            - –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã
            """)
        
        with col2:
            st.markdown("""
            **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
            
            ‚è∞ **–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏:**
            - AES-128: –º–∏–ª–ª–∏–∞—Ä–¥—ã –ª–µ—Ç
            - AES-256: –≤–æ–∑—Ä–∞—Å—Ç –í—Å–µ–ª–µ–Ω–Ω–æ–π √ó 10¬≤‚Å∞
            
            üí∞ **–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ:**
            - –°—Ç–æ–∏–º–æ—Å—Ç—å —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏
            - –ê–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
            - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∏–∑–¥–µ—Ä–∂–∫–∏
            
            üî¨ **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ:**
            - –ü–∞–º—è—Ç—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–ª—é—á–µ–π
            - –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
            - –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º
            """)
        
        # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞–º–∏
        st.markdown("### üåå –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º–∏ –º–∞—Å—à—Ç–∞–±–∞–º–∏")
        
        comparison_data = {
            '–ú–∞—Å—à—Ç–∞–±': ['–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ç–æ–º–æ–≤ –Ω–∞ –ó–µ–º–ª–µ', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤–µ–∑–¥ –≤–æ –í—Å–µ–ª–µ–Ω–Ω–æ–π', 
                        '–í–æ–∑—Ä–∞—Å—Ç –í—Å–µ–ª–µ–Ω–Ω–æ–π (—Å–µ–∫—É–Ω–¥—ã)', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ AES-128 –∫–ª—é—á–µ–π'],
            '–ó–Ω–∞—á–µ–Ω–∏–µ': ['~10‚Åµ‚Å∞', '~10¬≤‚Å¥', '~10¬π‚Å∑', '~10¬≥‚Å∏'],
            '–°—Ä–∞–≤–Ω–µ–Ω–∏–µ': ['–í 10¬π¬≤ —Ä–∞–∑ –±–æ–ª—å—à–µ', '–í 10¬π‚Å¥ —Ä–∞–∑ –º–µ–Ω—å—à–µ', '–í 10¬≤¬π —Ä–∞–∑ –º–µ–Ω—å—à–µ', '–≠—Ç–∞–ª–æ–Ω']
        }
        
        df = pd.DataFrame(comparison_data)
        st.dataframe(df, use_container_width=True, hide_index=True)
    
    def render_differential_analysis(self):
        """–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑"""
        st.subheader("üìä –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑ AES")
        
        st.markdown("""
        **–ü—Ä–∏–Ω—Ü–∏–ø –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞:**
        
        –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –ø–∞—Ä—ã –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ä–∞–∑–Ω–æ—Å—Ç—å—é –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–º —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç—ã.
        –¶–µ–ª—å - –Ω–∞–π—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–ª—é—á.
        
        **–î–ª—è AES –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –∏–∑-–∑–∞:**
        - –ù–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç–∏ S-–±–ª–æ–∫–æ–≤
        - –û–ø–µ—Ä–∞—Ü–∏–∏ MixColumns
        - –ë–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞—É–Ω–¥–æ–≤
        - –õ–∞–≤–∏–Ω–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞
        """)
        
        # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ª–∞–≤–∏–Ω–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞
        st.markdown("### üîÑ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ª–∞–≤–∏–Ω–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞")
        
        original_text = st.text_input(
            "–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç:",
            "Hello AES World!!",
            key="avalanche_text"
        )
        
        original_key = st.text_input(
            "–ö–ª—é—á:",
            "2b7e151628aed2a6abf7158809cf4f3c",
            key="avalanche_key"
        )
        
        if st.button("–ü–æ–∫–∞–∑–∞—Ç—å –ª–∞–≤–∏–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç", key="avalanche_btn"):
            if original_text and original_key:
                self.demo_avalanche_effect(original_text, original_key)
        
        # –ê–Ω–∞–ª–∏–∑ S-–±–ª–æ–∫–æ–≤
        st.markdown("---")
        self.render_sbox_analysis()
    
    def render_linear_analysis(self):
        """–õ–∏–Ω–µ–π–Ω—ã–π –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑"""
        st.subheader("üìà –õ–∏–Ω–µ–π–Ω—ã–π –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑ AES")
        
        st.markdown("""
        **–ü—Ä–∏–Ω—Ü–∏–ø –ª–∏–Ω–µ–π–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞:**
        
        –ü–æ–∏—Å–∫ –ª–∏–Ω–µ–π–Ω—ã—Ö –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–π –º–µ–∂–¥—É –±–∏—Ç–∞–º–∏ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞, —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞ –∏ –∫–ª—é—á–∞.
        –ï—Å–ª–∏ —Ç–∞–∫–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é ‚â† 0.5, –µ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∞—Ç–∞–∫–∏.
        
        **–°—Ç–æ–π–∫–æ—Å—Ç—å AES –∫ –ª–∏–Ω–µ–π–Ω–æ–º—É –∞–Ω–∞–ª–∏–∑—É:**
        - S-–±–ª–æ–∫–∏ –∏–º–µ—é—Ç –Ω–∏–∑–∫—É—é –ª–∏–Ω–µ–π–Ω—É—é –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—é
        - –û–ø–µ—Ä–∞—Ü–∏—è MixColumns —Ä–∞–∑—Ä—É—à–∞–µ—Ç –ª–∏–Ω–µ–π–Ω—ã–µ —Å–≤—è–∑–∏
        - –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–≥—Ä–æ–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä —Ç–µ–∫—Å—Ç-—à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç
        - –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–æ—Å—É—â–µ—Å—Ç–≤–∏–º–æ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ AES
        """)
        
        # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ª–∏–Ω–µ–π–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
        st.markdown("### üéØ –ê–Ω–∞–ª–∏–∑ –ª–∏–Ω–µ–π–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫")
        
        if st.button("–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–∏–Ω–µ–π–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞", key="linear_analysis_btn"):
            self.analyze_linear_properties()
        
        # –¢–∞–±–ª–∏—Ü–∞ –ª–∏–Ω–µ–π–Ω—ã—Ö –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–π
        st.markdown("---")
        self.render_linear_approximation_table()
    
    def render_timing_analysis(self):
        """–ê—Ç–∞–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏"""
        st.subheader("‚è±Ô∏è –ê—Ç–∞–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ AES")
        
        st.markdown("""
        **–ü—Ä–∏–Ω—Ü–∏–ø –∞—Ç–∞–∫ –ø–æ –≤—Ä–µ–º–µ–Ω–∏:**
        
        –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–ª—é—á–µ.
        –û—Å–æ–±–µ–Ω–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã –ø—Ä–æ—Ç–∏–≤ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π.
        
        **–£—è–∑–≤–∏–º—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ AES:**
        - –¢–∞–±–ª–∏—Ü—ã –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–æ–∫ (S-–±–ª–æ–∫–∏)
        - –û–ø–µ—Ä–∞—Ü–∏–∏ –≤ –∫–æ–Ω–µ—á–Ω–æ–º –ø–æ–ª–µ
        - –£—Å–ª–æ–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã
        - –î–æ—Å—Ç—É–ø –∫ –ø–∞–º—è—Ç–∏
        """)
        
        # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è timing attack
        st.markdown("### ‚ö° –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è timing attack")
        
        implementation_type = st.radio(
            "–¢–∏–ø —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:",
            ["–ó–∞—â–∏—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è", "–£—è–∑–≤–∏–º–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (—Å —É—Å–ª–æ–≤–Ω—ã–º–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏)"],
            key="impl_type"
        )
        
        if st.button("–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç—å", key="timing_test_btn"):
            self.demo_timing_attack(implementation_type)
        
        # –ó–∞—â–∏—Ç–∞ –æ—Ç timing attacks
        st.markdown("---")
        self.render_timing_protection()
    
    def render_comparative_analysis(self):
        """–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∞—Ç–∞–∫"""
        st.subheader("üî¨ –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∞—Ç–∞–∫ –Ω–∞ AES")
        
        # –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
        st.markdown("### üìä –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞—Ç–∞–∫")
        
        attacks_data = {
            '–¢–∏–ø –∞—Ç–∞–∫–∏': [
                '–ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–±–æ—Ä',
                '–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑', 
                '–õ–∏–Ω–µ–π–Ω—ã–π –∞–Ω–∞–ª–∏–∑',
                '–ê—Ç–∞–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏',
                '–ê—Ç–∞–∫–∞ –ø–æ –º–æ—â–Ω–æ—Å—Ç–∏',
                '–ê—Ç–∞–∫–∞ –ø–æ –∏–∑–ª—É—á–µ–Ω–∏—é',
                '–ê—Ç–∞–∫–∞ –Ω–∞ –∫—ç—à'
            ],
            '–°–ª–æ–∂–Ω–æ—Å—Ç—å AES-128': [
                '2¬π¬≤‚Å∏',
                '>2¬π‚Å∞‚Å∞', 
                '>2¬π¬≤‚Å∞',
                '2‚Å¥‚Å∞-2‚Å∂‚Å∞',
                '2¬≥‚Å∞-2‚Åµ‚Å∞',
                '2¬≤‚Å∞-2‚Å¥‚Å∞',
                '2¬π‚Å∞-2¬≥‚Å∞'
            ],
            '–ü—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å': [
                '–ù–µ–ø—Ä–∞–∫—Ç–∏—á–Ω–æ',
                '–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è', 
                '–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è',
                '–ü—Ä–∞–∫—Ç–∏—á–Ω–∞*',
                '–ü—Ä–∞–∫—Ç–∏—á–Ω–∞*',
                '–ü—Ä–∞–∫—Ç–∏—á–Ω–∞*',
                '–ü—Ä–∞–∫—Ç–∏—á–Ω–∞*'
            ],
            '–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è': [
                '–í—ã—á–∏—Å–ª–µ–Ω–∏—è',
                '–ú–Ω–æ–≥–æ –ø–∞—Ä —Ç–µ–∫—Å—Ç-—à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç', 
                '–û—á–µ–Ω—å –º–Ω–æ–≥–æ –ø–∞—Ä —Ç–µ–∫—Å—Ç-—à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç',
                '–î–æ—Å—Ç—É–ø –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É',
                '–§–∏–∑–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø',
                '–§–∏–∑–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø', 
                '–î–æ—Å—Ç—É–ø –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É'
            ]
        }
        
        df = pd.DataFrame(attacks_data)
        st.dataframe(df, use_container_width=True, hide_index=True)
        
        st.info("*–ü—Ä–∞–∫—Ç–∏—á–Ω–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Ç–∏–≤ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –∏–ª–∏ –ø—Ä–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º –¥–æ—Å—Ç—É–ø–µ")
        
        # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        st.markdown("---")
        st.markdown("### üìà –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏")
        
        if st.button("–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏", key="complexity_chart_btn"):
            self.plot_attack_complexity()
    
    def render_protection_recommendations(self):
        """–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞—â–∏—Ç–µ"""
        st.subheader("üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑–∞ AES")
        
        col1, col2 = st.columns(2)
        
        with col1:
            st.markdown("""
            **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
            
            ‚úÖ **–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
            - –ò–∑–±–µ–≥–∞—Ç—å —É—Å–ª–æ–≤–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
            - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã —Å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º
            - –ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π
            
            ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫ –ø–æ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º –∫–∞–Ω–∞–ª–∞–º:**
            - –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
            - –°–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏
            - –ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ—â–Ω–æ—Å—Ç–∏
            
            ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–π:**
            - –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ –º–æ–¥—É–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (HSM)
            - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π –≤ –ø–∞–º—è—Ç–∏
            - –†–µ–≥—É–ª—è—Ä–Ω–∞—è —Å–º–µ–Ω–∞ –∫–ª—é—á–µ–π
            """)
        
        with col2:
            st.markdown("""
            **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:**
            
            ‚úÖ **–í—ã–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
            - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AES-256 –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
            - –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
            - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π
            
            ‚úÖ **–†–µ–∂–∏–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:**
            - GCM –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
            - XTS –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–æ–≤
            - –ò–∑–±–µ–≥–∞—Ç—å ECB —Ä–µ–∂–∏–º–∞
            
            ‚úÖ **–ö–ª—é—á–µ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
            - –ù–∞–¥–µ–∂–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π
            - –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
            - –ü—Ä–æ—Ç–æ–∫–æ–ª—ã —Å forward secrecy
            """)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
        st.markdown("---")
        st.markdown("### üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏")
        
        if st.button("–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏", key="security_check_btn"):
            self.run_security_checks()
    
    def calculate_brute_force_time(self, key_size: str, computing_power: str, budget: float):
        """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Ä–µ–º—è –∞—Ç–∞–∫–∏ –ø–æ–ª–Ω—ã–º –ø–µ—Ä–µ–±–æ—Ä–æ–º"""
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞–∑–º–µ—Ä –∫–ª—é—á–∞
        if key_size == "AES-128":
            key_space = 2**128
            key_bits = 128
        elif key_size == "AES-192":
            key_space = 2**192
            key_bits = 192
        else:  # AES-256
            key_space = 2**256
            key_bits = 256
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—É—é –º–æ—â–Ω–æ—Å—Ç—å
        if "–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä" in computing_power:
            keys_per_second = 10**9
            cost_per_key = 1e-9  # $ –∑–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –∫–ª—é—á–∞
            system_name = "–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä"
        elif "–°—É–ø–µ—Ä–∫–æ–º–ø—å—é—Ç–µ—Ä" in computing_power:
            keys_per_second = 10**12
            cost_per_key = 1e-12
            system_name = "–°—É–ø–µ—Ä–∫–æ–º–ø—å—é—Ç–µ—Ä"
        elif "–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞" in computing_power:
            keys_per_second = 10**15
            cost_per_key = 1e-15
            system_name = "–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞"
        else:  # –ö–≤–∞–Ω—Ç–æ–≤—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä
            keys_per_second = 10**20  # –û—Ü–µ–Ω–∫–∞ –¥–ª—è –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤
            cost_per_key = 1e-20
            system_name = "–ö–≤–∞–Ω—Ç–æ–≤—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä"
        
        # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –≤—Ä–µ–º—è
        time_seconds = key_space / keys_per_second
        total_cost = key_space * cost_per_key
        
        # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤—Ä–µ–º—è –≤ —á–∏—Ç–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç
        years = time_seconds / (60 * 60 * 24 * 365)
        
        st.success(f"**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è {key_size}:**")
        
        col1, col2, col3 = st.columns(3)
        
        with col1:
            st.metric("–†–∞–∑–º–µ—Ä –∫–ª—é—á–µ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞", f"2^{key_bits}")
            st.metric("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª—é—á–µ–π", f"{key_space:.2e}")
        
        with col2:
            if years < 1:
                if time_seconds < 60:
                    time_str = f"{time_seconds:.2f} —Å–µ–∫—É–Ω–¥"
                elif time_seconds < 3600:
                    time_str = f"{time_seconds/60:.2f} –º–∏–Ω—É—Ç"
                else:
                    time_str = f"{time_seconds/3600:.2f} —á–∞—Å–æ–≤"
            else:
                if years > 1e9:
                    time_str = f"{years:.2e} –ª–µ—Ç"
                else:
                    time_str = f"{years:,.0f} –ª–µ—Ç"
            
            st.metric("–û—Ü–µ–Ω–æ—á–Ω–æ–µ –≤—Ä–µ–º—è", time_str)
            st.metric("–°–∏—Å—Ç–µ–º–∞", system_name)
        
        with col3:
            st.metric("–°—Ç–æ–∏–º–æ—Å—Ç—å –∞—Ç–∞–∫–∏", f"${total_cost:,.0f}")
            st.metric("–ë—é–¥–∂–µ—Ç –∞—Ç–∞–∫–∏", f"${budget:,.0f}M")
        
        # –í—ã–≤–æ–¥
        if total_cost > budget * 1e6:
            st.error("üö® –ê—Ç–∞–∫–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞: —Ç—Ä–µ–±—É–µ–º—ã–π –±—é–¥–∂–µ—Ç –ø—Ä–µ–≤—ã—à–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–π")
        else:
            st.warning("‚ö†Ô∏è –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–º–æ–∂–Ω–∞, –Ω–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–æ—Å—É—â–µ—Å—Ç–≤–∏–º–∞")
        
        # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –≤–æ–∑—Ä–∞—Å—Ç–æ–º –í—Å–µ–ª–µ–Ω–Ω–æ–π
        universe_age = 13.8e9  # –ª–µ—Ç
        if years > universe_age:
            st.info(f"üí´ –í—Ä–µ–º—è –≤–∑–ª–æ–º–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –≤–æ–∑—Ä–∞—Å—Ç –í—Å–µ–ª–µ–Ω–Ω–æ–π ({universe_age:.1e} –ª–µ—Ç) –≤ {years/universe_age:.1e} —Ä–∞–∑")
    
    def demo_brute_force(self):
        """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–±–æ—Ä–∞ –∫–ª—é—á–µ–π"""
        st.markdown("### üîé –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–±–æ—Ä–∞ 8-–±–∏—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞")
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π 8-–±–∏—Ç–Ω—ã–π –∫–ª—é—á
        secret_key = secrets.randbits(8)
        attempts = 0
        max_attempts = 256
        
        progress_bar = st.progress(0)
        status_text = st.empty()
        
        for guess in range(max_attempts):
            attempts += 1
            progress = (attempts / max_attempts)
            progress_bar.progress(progress)
            
            status_text.text(f"–ü–æ–ø—ã—Ç–∫–∞ {attempts}/256: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–∞ {guess:02x}...")
            
            # –ò–º–∏—Ç–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
            time.sleep(0.01)
            
            if guess == secret_key:
                status_text.success(f"‚úÖ –ö–ª—é—á –Ω–∞–π–¥–µ–Ω: {secret_key:02x} –ø–æ—Å–ª–µ {attempts} –ø–æ–ø—ã—Ç–æ–∫!")
                break
        else:
            status_text.error("‚ùå –ö–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        st.info(f"""
        **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏:**
        - –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∫–ª—é—á–µ–π: {attempts}
        - –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—Ö–∞: {attempts/256*100:.1f}%
        - –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –¥–ª—è AES-128: {2**128/attempts:.2e} —Ä–∞–∑ –¥–æ–ª—å—à–µ
        """)
    
    def demo_avalanche_effect(self, text: str, key: str):
        """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ª–∞–≤–∏–Ω–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞"""
        try:
            from modules.modern_crypto.aes import AESCipher
            aes = AESCipher()
            
            # –®–∏—Ñ—Ä—É–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
            if len(text) != 16:
                text = text[:16].ljust(16, ' ')
            
            original_cipher = aes.aes_encrypt(text, key, "128 –±–∏—Ç")
            
            # –ú–µ–Ω—è–µ–º –æ–¥–∏–Ω –±–∏—Ç –≤ —Ç–µ–∫—Å—Ç–µ
            text_bytes = bytearray(text.encode('utf-8'))
            text_bytes[0] ^= 1  # –ú–µ–Ω—è–µ–º –ø–µ—Ä–≤—ã–π –±–∏—Ç –ø–µ—Ä–≤–æ–≥–æ –±–∞–π—Ç–∞
            modified_text = text_bytes.decode('utf-8', errors='ignore')
            
            modified_cipher = aes.aes_encrypt(modified_text, key, "128 –±–∏—Ç")
            
            # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç—ã
            original_bits = bin(int(original_cipher, 16))[2:].zfill(128)
            modified_bits = bin(int(modified_cipher, 16))[2:].zfill(128)
            
            # –°—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –±–∏—Ç–æ–≤
            diff_count = sum(1 for a, b in zip(original_bits, modified_bits) if a != b)
            diff_percentage = (diff_count / 128) * 100
            
            col1, col2 = st.columns(2)
            
            with col1:
                st.markdown("**–ò—Å—Ö–æ–¥–Ω—ã–π —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç:**")
                st.code(original_cipher)
                st.markdown("**–ò–∑–º–µ–Ω–µ–Ω–Ω—ã–π —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç:**")
                st.code(modified_cipher)
            
            with col2:
                st.metric("–†–∞–∑–ª–∏—á–Ω—ã–µ –±–∏—Ç—ã", f"{diff_count}/128")
                st.metric("–ü—Ä–æ—Ü–µ–Ω—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π", f"{diff_percentage:.1f}%")
                
                if diff_percentage > 45:
                    st.success("‚úÖ –°–∏–ª—å–Ω—ã–π –ª–∞–≤–∏–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç")
                else:
                    st.warning("‚ö†Ô∏è –°–ª–∞–±—ã–π –ª–∞–≤–∏–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç")
            
            # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑–ª–∏—á–∏–π
            st.markdown("### üéØ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π")
            
            fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 4))
            
            # –ò—Å—Ö–æ–¥–Ω—ã–π —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç
            original_matrix = np.array([int(bit) for bit in original_bits]).reshape(8, 16)
            sns.heatmap(original_matrix, ax=ax1, cmap="Blues", cbar=False)
            ax1.set_title("–ò—Å—Ö–æ–¥–Ω—ã–π —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç")
            
            # –†–∞–∑–ª–∏—á–∏—è
            diff_matrix = np.array([1 if a != b else 0 for a, b in zip(original_bits, modified_bits)]).reshape(8, 16)
            sns.heatmap(diff_matrix, ax=ax2, cmap="Reds", cbar=False)
            ax2.set_title("–ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –±–∏—Ç—ã (–∫—Ä–∞—Å–Ω—ã–µ)")
            
            st.pyplot(fig)
            
        except ImportError:
            st.error("–ú–æ–¥—É–ª—å AES –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏")
    
    def render_sbox_analysis(self):
        """–ê–Ω–∞–ª–∏–∑ S-–±–ª–æ–∫–æ–≤"""
        st.markdown("### üîç –ê–Ω–∞–ª–∏–∑ S-–±–ª–æ–∫–æ–≤ AES")
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–≤–æ–π—Å—Ç–≤–∞ S-–±–ª–æ–∫–∞
        st.markdown("**–°–≤–æ–π—Å—Ç–≤–∞ S-–±–ª–æ–∫–∞ AES:**")
        
        properties_data = {
            '–°–≤–æ–π—Å—Ç–≤–æ': [
                '–ù–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å',
                '–°—Ç—Ä–æ–≥–∞—è –ª–∞–≤–∏–Ω–Ω–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å', 
                '–ü–æ–ª–Ω–æ—Ç–∞',
                '–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å',
                '–ò–º–º—É–Ω–∏—Ç–µ—Ç –∫ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º—É –∞–Ω–∞–ª–∏–∑—É',
                '–ò–º–º—É–Ω–∏—Ç–µ—Ç –∫ –ª–∏–Ω–µ–π–Ω–æ–º—É –∞–Ω–∞–ª–∏–∑—É'
            ],
            '–ó–Ω–∞—á–µ–Ω–∏–µ': [
                '112',
                '–î–∞', 
                '–î–∞',
                '–î–∞',
                '–í—ã—Å–æ–∫–∏–π',
                '–í—ã—Å–æ–∫–∏–π'
            ],
            '–û–ø–∏—Å–∞–Ω–∏–µ': [
                '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å –¥–ª—è 8x8 S-–±–ª–æ–∫–∞',
                '–ò–∑–º–µ–Ω–µ–Ω–∏–µ 1 –±–∏—Ç–∞ –≤—Ö–æ–¥–∞ –º–µ–Ω—è–µ—Ç ~50% –±–∏—Ç–æ–≤ –≤—ã—Ö–æ–¥–∞',
                '–ö–∞–∂–¥—ã–π –≤—ã—Ö–æ–¥–Ω–æ–π –±–∏—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –±–∏—Ç–æ–≤',
                '–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π',
                '–ù–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫',
                '–ù–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –ª–∏–Ω–µ–π–Ω—ã—Ö –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–π'
            ]
        }
        
        df = pd.DataFrame(properties_data)
        st.dataframe(df, use_container_width=True, hide_index=True)
    
    def analyze_linear_properties(self):
        """–ê–Ω–∞–ª–∏–∑ –ª–∏–Ω–µ–π–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤"""
        st.markdown("### üìä –ê–Ω–∞–ª–∏–∑ –ª–∏–Ω–µ–π–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ S-–±–ª–æ–∫–∞")
        
        # –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –ª–∏–Ω–µ–π–Ω—ã—Ö –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–π (—É–ø—Ä–æ—â–µ–Ω–Ω—É—é)
        linear_data = []
        for input_mask in range(16):  # –¢–æ–ª—å–∫–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
            for output_mask in range(16):
                correlation = secrets.randbits(3) / 10 - 0.35  # –°–ª—É—á–∞–π–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
                linear_data.append({
                    '–í—Ö–æ–¥–Ω–∞—è –º–∞—Å–∫–∞': f"{input_mask:04b}",
                    '–í—ã—Ö–æ–¥–Ω–∞—è –º–∞—Å–∫–∞': f"{output_mask:04b}",
                    '–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è': f"{correlation:.3f}",
                    '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å': '–ù–∏–∑–∫–∞—è' if abs(correlation) < 0.1 else '–°—Ä–µ–¥–Ω—è—è' if abs(correlation) < 0.2 else '–í—ã—Å–æ–∫–∞—è'
                })
        
        df_linear = pd.DataFrame(linear_data[:50])  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 50
        st.dataframe(df_linear, use_container_width=True, height=300)
        
        st.info("""
        **–í—ã–≤–æ–¥—ã –∞–Ω–∞–ª–∏–∑–∞:**
        - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ª–∏–Ω–µ–π–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è: ~0.25 (–¥–ª—è —É–ø—Ä–æ—â–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞)
        - –í —Ä–µ–∞–ª—å–Ω–æ–º AES –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è: < 2‚Åª‚Å∂
        - –¢—Ä–µ–±—É–µ—Ç—Å—è >2¬π¬≤‚Å∞ –ø–∞—Ä —Ç–µ–∫—Å—Ç-—à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç –¥–ª—è —É—Å–ø–µ—à–Ω–æ–π –∞—Ç–∞–∫–∏
        - –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–æ—Å—É—â–µ—Å—Ç–≤–∏–º–æ
        """)
    
    def render_linear_approximation_table(self):
        """–¢–∞–±–ª–∏—Ü–∞ –ª–∏–Ω–µ–π–Ω—ã—Ö –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–π"""
        st.markdown("### üéØ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–Ω–µ–π–Ω—ã—Ö –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–π (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è)")
        
        # –°–æ–∑–¥–∞–µ–º –ø—Ä–∏–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã
        lat_data = []
        for i in range(8):
            row = []
            for j in range(8):
                # –°–ª—É—á–∞–π–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
                value = secrets.choice([-4, -2, 0, 2, 4])
                row.append(value)
            lat_data.append(row)
        
        df_lat = pd.DataFrame(lat_data)
        df_lat.columns = [f'Out {i}' for i in range(8)]
        df_lat.index = [f'In {i}' for i in range(8)]
        
        st.dataframe(df_lat, use_container_width=True)
        
        st.markdown("""
        **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
        - –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
        - –ù—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏
        - –í —Ä–µ–∞–ª—å–Ω–æ–º AES –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ—á–µ–Ω—å –º–∞–ª—ã
        """)
    
    def demo_timing_attack(self, implementation_type: str):
        """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è timing attack"""
        st.markdown("### ‚è±Ô∏è –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è")
        
        # –ò–º–∏—Ç–∏—Ä—É–µ–º timing attack
        times = []
        operations = []
        
        for i in range(100):
            if implementation_type == "–£—è–∑–≤–∏–º–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (—Å —É—Å–ª–æ–≤–Ω—ã–º–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏)":
                # –ò–º–∏—Ç–∏—Ä—É–µ–º —É—è–∑–≤–∏–º—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
                if i % 10 == 0:  # –£—Å–ª–æ–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥
                    time_taken = 0.1 + secrets.randbits(3) / 100  # –ë–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏
                else:
                    time_taken = 0.1 + secrets.randbits(1) / 100  # –ú–µ–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏
            else:
                # –ó–∞—â–∏—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
                time_taken = 0.1 + secrets.randbits(2) / 100  # –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –≤—Ä–µ–º—è
            
            times.append(time_taken)
            operations.append(f"–û–ø–µ—Ä–∞—Ü–∏—è {i+1}")
        
        # –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫
        fig, ax = plt.subplots(figsize=(10, 4))
        ax.plot(operations[::10], times[::10], 'o-', alpha=0.7)
        ax.set_xlabel('–ù–æ–º–µ—Ä –æ–ø–µ—Ä–∞—Ü–∏–∏')
        ax.set_ylabel('–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (—Å–µ–∫)')
        ax.set_title('–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π AES')
        ax.grid(True, alpha=0.3)
        
        st.pyplot(fig)
        
        # –ê–Ω–∞–ª–∏–∑
        time_std = np.std(times)
        
        if implementation_type == "–£—è–∑–≤–∏–º–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (—Å —É—Å–ª–æ–≤–Ω—ã–º–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏)":
            if time_std > 0.02:
                st.error(f"üö® –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—å! –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {time_std:.4f}")
                st.warning("–ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —à–∞–±–ª–æ–Ω—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –∏–∑–≤–ª–µ—á—å –∫–ª—é—á")
            else:
                st.success(f"‚úÖ –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ: {time_std:.4f}")
        else:
            if time_std < 0.015:
                st.success(f"‚úÖ –ó–∞—â–∏—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: {time_std:.4f}")
            else:
                st.warning(f"‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∫–æ–ª–µ–±–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏: {time_std:.4f}")
    
    def render_timing_protection(self):
        """–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞—â–∏—Ç–µ –æ—Ç timing attacks"""
        st.markdown("### üõ°Ô∏è –ú–µ—Ç–æ–¥—ã –∑–∞—â–∏—Ç—ã –æ—Ç timing attacks")
        
        protection_data = {
            '–ú–µ—Ç–æ–¥ –∑–∞—â–∏—Ç—ã': [
                '–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è',
                '–ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö',
                '–°–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏',
                '–ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è',
                '–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–¥–∞'
            ],
            '–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã': [
                '–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∑–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –≤—Ä–µ–º—è',
                '–î–∞–Ω–Ω—ã–µ –º–∞—Å–∫–∏—Ä—É—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏',
                '–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω—ã—Ö –∑–∞–¥–µ—Ä–∂–µ–∫ –≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ',
                '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ hardware',
                '–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏'
            ],
            '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å': [
                '–í—ã—Å–æ–∫–∞—è',
                '–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è', 
                '–°—Ä–µ–¥–Ω—è—è',
                '–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è',
                '–í—ã—Å–æ–∫–∞—è'
            ]
        }
        
        df = pd.DataFrame(protection_data)
        st.dataframe(df, use_container_width=True, hide_index=True)
    
    def plot_attack_complexity(self):
        """–°—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ–∏–∫ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∞—Ç–∞–∫"""
        st.markdown("### üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∞—Ç–∞–∫")
        
        # –î–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
        attacks = ['–ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–±–æ—Ä\nAES-128', '–ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–±–æ—Ä\nAES-256', 
                  '–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π\n–∞–Ω–∞–ª–∏–∑', '–õ–∏–Ω–µ–π–Ω—ã–π\n–∞–Ω–∞–ª–∏–∑', '–ê—Ç–∞–∫–∞ –ø–æ\n–≤—Ä–µ–º–µ–Ω–∏']
        complexities = [2**128, 2**256, 2**100, 2**120, 2**40]
        
        # –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è —à–∫–∞–ª–∞
        log_complexities = [np.log2(c) for c in complexities]
        
        fig, ax = plt.subplots(figsize=(10, 6))
        bars = ax.bar(attacks, log_complexities, color=['red', 'darkred', 'orange', 'yellow', 'green'])
        
        ax.set_ylabel('–õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å (log‚ÇÇ –æ–ø–µ—Ä–∞—Ü–∏–π)')
        ax.set_title('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∞—Ç–∞–∫ –Ω–∞ AES')
        ax.grid(True, alpha=0.3, axis='y')
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ —Å—Ç–æ–ª–±—Ü—ã
        for bar, complexity in zip(bars, complexities):
            height = bar.get_height()
            ax.text(bar.get_x() + bar.get_width()/2., height + 1,
                   f'2^{int(height)}', ha='center', va='bottom')
        
        st.pyplot(fig)
        
        st.info("""
        **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
        - –ê—Ç–∞–∫–∏ –ø–æ–ª–Ω—ã–º –ø–µ—Ä–µ–±–æ—Ä–æ–º –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–æ—Å—É—â–µ—Å—Ç–≤–∏–º—ã
        - –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∏ –ª–∏–Ω–µ–π–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–º–æ–∂–Ω—ã, –Ω–æ —Ç—Ä–µ–±—É—é—Ç –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö
        - –ê—Ç–∞–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∞–∫—Ç–∏—á–Ω—ã —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Ç–∏–≤ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π
        """)
    
    def run_security_checks(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"""
        st.markdown("### üîí –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏")
        
        checks = [
            ("–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è", True),
            ("–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —É—Å–ª–æ–≤–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤", True),
            ("–ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫ –ø–æ –º–æ—â–Ω–æ—Å—Ç–∏", False),
            ("–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö", True),
            ("–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–π", True),
            ("–ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫ –Ω–∞ –∫—ç—à", False),
            ("–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö", True)
        ]
        
        passed = 0
        total = len(checks)
        
        for check_name, status in checks:
            col1, col2 = st.columns([3, 1])
            with col1:
                st.write(check_name)
            with col2:
                if status:
                    st.success("‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ")
                    passed += 1
                else:
                    st.error("‚ùå –ù–µ –ø—Ä–æ–π–¥–µ–Ω–æ")
        
        # –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞
        score = (passed / total) * 100
        st.markdown(f"**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: {score:.1f}%**")
        
        if score >= 80:
            st.success("üéâ –í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏")
        elif score >= 60:
            st.warning("‚ö†Ô∏è –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏")
        else:
            st.error("üö® –ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ - —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞")

# –î–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
class AESCryptanalysis(AESCryptanalysisModule):
    pass
